(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{10:function(e,t,a){e.exports=a.p+"static/media/logo.94cbab21.svg"},14:function(e,t,a){e.exports=a(21)},19:function(e,t,a){},21:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(8),o=a.n(c),s=(a(19),a(13)),l=a(6),i=a.n(l),u=a(9),m=a(1),d=a(10),f=a.n(d);var p=function(){return r.a.createElement("header",{className:"header"},r.a.createElement("img",{src:f.a,className:"header__logo",alt:"\u041c\u0435\u0441\u0442\u043e"}))},h=r.a.createContext();var _=function(e){var t=r.a.useContext(h),a=e.owner._id===t._id,n="element__delete ".concat(a?"element__delete":"element__delete_disable"),c=e.likes.some((function(e){return e._id===t._id})),o="element__like".concat(c?" element__like_active":"");return r.a.createElement("li",{className:"element"},r.a.createElement("button",{type:"button",className:n,title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",onClick:function(){e.onCardDelete(e)}}),r.a.createElement("img",{className:"element__image",src:e.link,alt:e.name,onClick:function(){e.onCardClick({name:e.name,link:e.link})}}),r.a.createElement("div",{className:"element__name"},r.a.createElement("h3",{className:"element__title"},e.name),r.a.createElement("div",{className:"element__likesinfo"},r.a.createElement("button",{type:"button",className:o,title:"\u041d\u0440\u0430\u0432\u0438\u0442\u0441\u044f",onClick:function(){e.onCardLike(e)}}),r.a.createElement("div",{className:"element__likecount"},e.likes.length))))};var b=function(e){var t=r.a.useContext(h);return r.a.createElement("main",{className:"content"},r.a.createElement("section",{className:"lead"},r.a.createElement("a",{href:"#",className:"lead__avatar-cover",onClick:e.onEditAvatar},r.a.createElement("img",{alt:t?t.name:"",src:t?t.avatar:"",className:"lead__avatar"})),r.a.createElement("div",{className:"lead__profile-info"},r.a.createElement("div",{className:"lead__profile-header"},r.a.createElement("h1",{className:"lead__name"},t?t.name:""),r.a.createElement("button",{type:"button",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c",className:"lead__edit-button",onClick:e.onEditProfile})),r.a.createElement("p",{className:"lead__text"},t?t.about:"")),r.a.createElement("button",{type:"button",className:"lead__add-button",title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",onClick:e.onAddPlace})),r.a.createElement("section",{className:"elements"},r.a.createElement("ul",{className:"elements__list"},e.cards.map((function(t){return r.a.createElement(_,Object.assign({key:t._id},t,{onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete}))})))))};var v=function(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))};var E=function(e){return r.a.createElement("div",{className:"popup popup_type_".concat(e.name," ").concat(e.isOpen?"popup_opened":"")},r.a.createElement("div",{className:"popup__container"},r.a.createElement("form",{name:"form_type_".concat(e.name),className:"form",noValidate:!0,onSubmit:e.onSubmit},r.a.createElement("div",{className:"form__edit"},r.a.createElement("h2",{className:"form__title"},e.title),e.children,r.a.createElement("input",{type:"submit",value:e.submitText,className:"form__submit"})),r.a.createElement("button",{type:"button",className:"form__close",title:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",onClick:e.onClose}))))},k=a(2),C=a(3);var N=function(e){var t=r.a.useContext(h),a=r.a.useState({name:"",about:""}),c=Object(m.a)(a,2),o=c[0],s=c[1];function l(e){var t=e.target,a=t.name,n=t.value;s(Object(C.a)(Object(C.a)({},o),{},Object(k.a)({},a,n)))}return Object(n.useEffect)((function(){s({name:t?t.name:"",about:t?t.about:""})}),[t]),r.a.createElement(E,{name:"edit",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",submitText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",onSubmit:function(t){t.preventDefault(),e.onUpdateUser(o)},isOpen:e.isOpen,onClose:e.onClose},r.a.createElement("input",{value:o.name,type:"text",className:"form__edt-text",name:"name",minLength:"2",maxLength:"40",required:!0,placeholder:"\u0418\u043c\u044f",onChange:l}),r.a.createElement("span",{id:"name-error",className:"form__error"}),r.a.createElement("input",{value:o.about,type:"text",className:"form__edt-text",name:"about",minLength:"2",maxLength:"200",required:!0,placeholder:"\u041e \u0441\u0435\u0431\u0435",onChange:l}),r.a.createElement("span",{id:"about-error",className:"form__error"}))};var g=function(e){var t=Object(n.useRef)(null);return r.a.createElement(E,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",submitText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:e.isOpen,onSubmit:function(a){a.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})},onClose:e.onClose},r.a.createElement("input",{className:"form__edt-text",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",ref:t,required:!0,type:"url",pattern:"https://.*"}),r.a.createElement("span",{id:"link-error",className:"form__error"}))};var O=function(e){var t=r.a.useState({name:"",link:""}),a=Object(m.a)(t,2),n=a[0],c=a[1];function o(e){var t=e.target,a=t.name,r=t.value;c(Object(C.a)(Object(C.a)({},n),{},Object(k.a)({},a,r)))}return r.a.createElement(E,{name:"add",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",submitText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:e.isOpen,onSubmit:function(t){t.preventDefault(),e.onAddPlace(n),setTimeout((function(){c({name:"",link:""})}),1e3)},onClose:e.onClose},r.a.createElement("input",{type:"text",value:n.name,className:"form__edt-text",name:"name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,minLength:"1",maxLength:"30",onChange:o}),r.a.createElement("span",{id:"name-error",className:"form__error"}),r.a.createElement("input",{value:n.link,className:"form__edt-text",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,type:"url",pattern:"https://.*",onChange:o}),r.a.createElement("span",{id:"link-error",className:"form__error"}))};var j=function(e){var t=e.isOpen,a=e.onClose,n=e.card;return r.a.createElement("div",{className:"popup popup_bigimage  ".concat(t?"popup_opened":"")},r.a.createElement("div",{className:"popup__container popup__container_bigimage"},r.a.createElement("figure",{className:"popup__images"},r.a.createElement("img",{className:"popup__image",alt:t?n.name:"",src:t?n.link:""}),r.a.createElement("figcaption",{className:"popup__caption"},t?n.name:"")),r.a.createElement("button",{type:"button",className:"form__close",title:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",onClick:a})))},y=a(11),x=a(12),S=new(function(){function e(t){Object(y.a)(this,e),this.baseUrl=t.baseUrl,this.headers=t.headers}return Object(x.a)(e,[{key:"getInitialCards",value:function(){return fetch("".concat(this.baseUrl,"cards"),{headers:this.headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"getInitialUser",value:function(){return fetch("".concat(this.baseUrl,"users/me"),{headers:this.headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"putUserInfo",value:function(e){return fetch("".concat(this.baseUrl,"users/me"),{method:"PATCH",headers:this.headers,body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"putAvatarInfo",value:function(e){return console.log(e),fetch("".concat(this.baseUrl,"users/me/avatar"),{method:"PATCH",headers:this.headers,body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this.baseUrl,"cards/").concat(e),{method:"DELETE",headers:this.headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"createCard",value:function(e){return fetch("".concat(this.baseUrl,"cards"),{method:"POST",headers:this.headers,body:JSON.stringify(e)}).then((function(e){return e.json()}))}},{key:"putLike",value:function(e){return fetch("".concat(this.baseUrl,"cards/likes/").concat(e),{method:"PUT",headers:this.headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"deleteLike",value:function(e){return fetch("".concat(this.baseUrl,"cards/likes/").concat(e),{method:"DELETE",headers:this.headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"changeLikeCardStatus",value:function(e,t){return t?this.putLike(e):this.deleteLike(e)}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-14/",headers:{authorization:"b5b09145-9ffa-43dc-a8a7-afd53c9e00bd","Content-Type":"application/json"}});var U=function(){var e=r.a.useState(!1),t=Object(m.a)(e,2),a=t[0],c=t[1],o=r.a.useState(!1),l=Object(m.a)(o,2),d=l[0],f=l[1],_=r.a.useState(!1),k=Object(m.a)(_,2),C=k[0],y=k[1],x=r.a.useState(!1),U=Object(m.a)(x,2),L=U[0],P=U[1],A=r.a.useState(!1),T=Object(m.a)(A,2),D=T[0],I=T[1],w=r.a.useState(null),q=Object(m.a)(w,2),J=q[0],H=q[1],M=r.a.useState(null),R=Object(m.a)(M,2),z=R[0],B=R[1],V=r.a.useState([]),F=Object(m.a)(V,2),G=F[0],K=F[1],Q=function(){var e=Object(u.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.getInitialUser();case 3:return t=e.sent,e.next=6,S.getInitialCards();case 6:a=e.sent,B(t),K(a),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:return e.prev=14,e.finish(14);case 16:case"end":return e.stop()}}),e,null,[[0,11,14,16]])})));return function(){return e.apply(this,arguments)}}();function W(){f(!1),y(!1),c(!1),P(!1),I(!1),H(null)}return Object(n.useEffect)((function(){Q()}),[]),r.a.createElement(h.Provider,{value:z},r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"page"},r.a.createElement(p,null),r.a.createElement(b,{onEditAvatar:function(){c(!0)},onEditProfile:function(){f(!0)},onAddPlace:function(){y(!0)},onCardClick:function(e){I(!0),H(e)},onDeleteImg:function(){P(!0)},cards:G,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===z._id}));S.changeLikeCardStatus(e._id,!t).then((function(t){var a=G.map((function(a){return a._id===e._id?t:a}));K(a)}))},onCardDelete:function(e){S.deleteCard(e._id).then((function(){var t=G.filter((function(t){return t._id!==e._id}));K(t)}))}}),r.a.createElement(v,null)),r.a.createElement(N,{onUpdateUser:function(e){S.putUserInfo(e).then((function(e){B(e),f(!1)})).catch((function(e){return console.log(e)}))},isOpen:d,onClose:W}),r.a.createElement(O,{onAddPlace:function(e){S.createCard(e).then((function(e){K([e].concat(Object(s.a)(G))),y(!1)})).catch((function(e){return console.log(e)}))},isOpen:C,onClose:W}),r.a.createElement(g,{isOpen:a,onClose:W,onUpdateAvatar:function(e){S.putAvatarInfo(e).then((function(e){B(e),c(!1)})).catch((function(e){return console.log(e)}))}}),r.a.createElement(E,{name:"delete",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",submitText:"\u0414\u0430",isOpen:L,onClose:W}),r.a.createElement(j,{isOpen:D,onClose:W,card:J})))};o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(U,null)),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.c33401a3.chunk.js.map